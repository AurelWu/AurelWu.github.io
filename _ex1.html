<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HexMapLibrary: Example 1: Mouse markers and simple map manipulation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HexMapLibrary
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">HexMap Library Documentation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Example 1: Mouse markers and simple map manipulation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this example we are going to create a HexMap with a rectangular shape and will assign a random value to each of those tiles which we will visualise by using different colors. We then will add the HexMouse component to get the position of the mouse and display the tile the cursor is on as well as the closest tile and edge. When clicking a tile it will change its value.</p>
<p>As in the previous example we will add the using statements for our library and position the camera correctly so these things are not covered again here.</p>
<p>This time we will need a few more prefabs &amp; variables :</p>
<div class="fragment"><div class="line">[SerializeField] <span class="keyword">private</span> Vector2Int mapSize = <span class="keyword">new</span> Vector2Int(13, 13);</div><div class="line">[SerializeField] <span class="keyword">private</span> GameObject tilePrefab = null; <span class="comment">// the prefab we use for each Tile -&gt; use TilePrefab.prefab </span></div><div class="line">[SerializeField] <span class="keyword">private</span> GameObject edgePrefab = null; <span class="comment">// the prefab we use for each Edge -&gt; use EdgePrefab.prefab </span></div><div class="line">[SerializeField] <span class="keyword">private</span> GameObject tileMarker = null; <span class="comment">// a GameObject we use to show the current mouse position -&gt; put an instance of TileMarker.prefab in the scene and reference it in the inspector</span></div><div class="line">[SerializeField] <span class="keyword">private</span> GameObject edgeMarker = null; <span class="comment">// a GameObject we use to we show the closest edge to the current mouse position  -&gt; put an instance of EdgeMarker.prefab in the scene and reference it in the inspector</span></div><div class="line">[SerializeField] <span class="keyword">private</span> GameObject cornerMarker = null; <span class="comment">// a GameObject we use to show the closest corner to the current mouse position  -&gt; put an instance of CornerMarker.prefab in the scene and reference it in the inspector</span></div><div class="line">[SerializeField] <span class="keyword">private</span> List&lt;Material&gt; materials = null; <span class="comment">// the materials we want to assign to the tiles for visualisation purposes -&gt; set size to 4 in inspector and add TileMat1 to TileMat4</span></div><div class="line"><span class="keyword">private</span> HexMap&lt;int,bool&gt; hexMap; <span class="comment">// our map. For this example we create a map where an integer represents the data of each tile and a bool the data of each edge</span></div><div class="line"><span class="keyword">private</span> HexMouse hexMouse = null; <span class="comment">// the HexMouse component we add to keep track of the mouse position</span></div><div class="line"><span class="keyword">private</span> GameObject[] tileObjects; <span class="comment">// this will contain all the GameObjects for visualisation purposes, their array index corresponds with the index of our Tiles</span></div></div><!-- fragment --><p>Now it is time to create our map:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> Start ()</div><div class="line">{</div><div class="line">    hexMap = <span class="keyword">new</span> HexMap&lt;int, bool&gt;(HexMapBuilder.CreateRectangularShapedMap(mapSize), null); <span class="comment">//creates a HexMap using one of the pre-defined shapes in the static MapBuilder Class            </span></div><div class="line">    hexMouse = gameObject.AddComponent&lt;HexMouse&gt;(); <span class="comment">//we attach the HexMouse script to the same gameObject this script is attached to, could also attach it anywhere else</span></div><div class="line">    hexMouse.Init(hexMap); <span class="comment">//initializes the HexMouse </span></div><div class="line">    tileObjects = <span class="keyword">new</span> GameObject[hexMap.TilesByPosition.Count]; <span class="comment">//creates an array with the size equal to the number on tiles of the map</span></div><div class="line"></div><div class="line">    <span class="keywordflow">foreach</span> (var tile <span class="keywordflow">in</span> hexMap.Tiles) <span class="comment">//loops through all the tiles, assigns them a random value and instantiates and positions a gameObject for each of them.</span></div><div class="line">    {</div><div class="line">        tile.Data = (Random.Range(0, 4));</div><div class="line">        GameObject instance = GameObject.Instantiate(tilePrefab);</div><div class="line">        instance.GetComponent&lt;Renderer&gt;().material = materials[tile.Data];</div><div class="line">        instance.name = <span class="stringliteral">&quot;MapTile_&quot;</span> + tile.Position;</div><div class="line">        instance.transform.position = tile.CartesianPosition;</div><div class="line">        tileObjects[tile.Index] = instance;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">foreach</span> (var edge <span class="keywordflow">in</span> hexMap.Edges) <span class="comment">//we randomly spawn a GameObject on some corners (could be representing walls or rivers or anything else)</span></div><div class="line">    {</div><div class="line">        <span class="keywordtype">int</span> randomNumber = Random.Range(0, 100);</div><div class="line">        <span class="keywordflow">if</span> (randomNumber &gt; 89)</div><div class="line">        {</div><div class="line">            edge.Data = <span class="keyword">true</span>;</div><div class="line">            GameObject instance = GameObject.Instantiate(edgePrefab);</div><div class="line">            instance.name = <span class="stringliteral">&quot;MapEdge_&quot;</span> + edge.Position;</div><div class="line">            instance.transform.position = edge.CartesianPosition;</div><div class="line">            instance.transform.rotation = Quaternion.Euler(0, edge.EdgeAlignmentAngle, 0);</div><div class="line">            <span class="comment">//as we don&#39;t change the edges during runtime we don&#39;t need to add the gameObjects of the edges to an array as we don&#39;t need to manipulate them later on</span></div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    SetupCamera(); <span class="comment">//put the camera related lines from previous script in that method</span></div><div class="line">}</div></div><!-- fragment --><p>If you run the scene now, it should look similar to this: </p><div class="image">
<img src="Example1_1.png" alt="Example1_1.png"/>
</div>
<p>Finally we add our update method which will highlight the current tile and closest edge of our mouse position and when we leftclick we will change the value of the current tile </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Update ()</div><div class="line">{ </div><div class="line">    <span class="keywordflow">if</span> (!hexMouse.CursorIsOnMap) <span class="keywordflow">return</span>; <span class="comment">// if we are not on the map we won&#39;t do anything so we can return</span></div><div class="line"></div><div class="line">    Vector3Int mouseTilePosition = hexMouse.TileCoord;</div><div class="line">    Vector3Int mouseEdgePosition = hexMouse.ClosestEdgeCoord;</div><div class="line">    Vector3Int mouseCornerPosition = hexMouse.ClosestCornerCoord;</div><div class="line"></div><div class="line">    <span class="comment">//update the marker positions</span></div><div class="line">    tileMarker.transform.position = HexConverter.TileCoordToCartesianCoord(mouseTilePosition, 0.1f); <span class="comment">//we put our tile marker on the tile our mouse is on</span></div><div class="line">    edgeMarker.transform.position = HexConverter.EdgeCoordToCartesianCoord(mouseEdgePosition); <span class="comment">// we put our edge marker on the closest edge of our mouse position            </span></div><div class="line">    edgeMarker.transform.rotation = Quaternion.Euler(0, hexMap.EdgesByPosition[mouseEdgePosition].EdgeAlignmentAngle, 0); <span class="comment">//we set the rotation of the edge marker</span></div><div class="line">    cornerMarker.transform.position = HexConverter.CornerCoordToCartesianCoord(mouseCornerPosition);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (Input.GetMouseButtonDown(0)) <span class="comment">// change a tile when clicked on it</span></div><div class="line">    {</div><div class="line">        Tile&lt;int&gt; t = hexMap.TilesByPosition[mouseTilePosition]; <span class="comment">//we select the tile our mouse is on</span></div><div class="line">        <span class="keywordtype">int</span> curValue = t.Data; <span class="comment">//we grab the current value of the tile</span></div><div class="line">        t.Data = ((curValue + 1) % 4); <span class="comment">//we increment it and use modulo to keep it between 0 and 3</span></div><div class="line">        tileObjects[t.Index].GetComponent&lt;Renderer&gt;().material = materials[t.Data]; <span class="comment">// we update the material of the GameObject representing the tile based on the new value</span></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>This concludes this example, now let's continue with the next [ADD LINK] </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
